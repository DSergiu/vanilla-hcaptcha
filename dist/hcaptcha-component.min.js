!function(){"use strict";const t="hcaptcha-api-script-id",e="_hcaptchaOnLoad";let i,a;const h=new Promise(((t,e)=>{i=t,a=e}));function n(n){if(window.hcaptcha)return i(),h;if(document.getElementById(t))return h;window._hcaptchaOnLoad=i;const s=function(t){let i=t.apiEndpoint;return i=r(i,"render","explicit"),i=r(i,"onload",e),i=r(i,"recaptchacompat",!1===t.reCaptchaCompat?"off":null),i=r(i,"hl",t.language),i=r(i,"sentry",t.sentry),i=r(i,"endpoint",t.endpoint),i=r(i,"assethost",t.assethost),i=r(i,"imghost",t.imghost),i=r(i,"reportapi",t.reportapi),i}(n),o=document.createElement("script");return o.id=t,o.src=s,o.async=!0,o.defer=!0,o.onerror=t=>{console.error("Failed to load api: "+s,t),a("Failed to load api.js")},document.head.appendChild(o),h}function r(t,e,i){if(null!=i){const a=t.includes("?")?"&":"?";return t+a+e+"="+encodeURIComponent(i)}return t}class s extends HTMLElement{connectedCallback(){this.config={sitekey:this.getAttribute("sitekey")||this.getAttribute("site-key"),theme:this.getAttribute("theme")||null!==this.getAttribute("dark")?"dark":void 0,size:this.getAttribute("size"),tabindex:this.getAttribute("tabindex"),language:this.getAttribute("language"),reCaptchaCompat:"false"===this.getAttribute("reCaptchaCompat"),challengeContainer:this.getAttribute("challengeContainer"),rqdata:this.getAttribute("rqdata"),sentry:"true"===this.getAttribute("sentry"),apiEndpoint:this.getAttribute("apiendpoint")||"https://hcaptcha.com/1/api.js",endpoint:this.getAttribute("endpoint"),reportapi:this.getAttribute("reportapi"),assethost:this.getAttribute("assethost"),imghost:this.getAttribute("imghost")},n(this.config).then(this._apiLoaded.bind(this)).catch(this.onError.bind(this))}$emit(t,e){let i;"function"==typeof Event?i=new Event(t):(i=document.createEvent("Event"),i.initEvent(t,!1,!1)),e&&Object.assign(i,e),this.dispatchEvent(i)}_apiLoaded(){this.hcaptcha=window.hcaptcha,this.$emit("loaded"),this.render()}render(){if(this.hcaptchaId)return void console.warn("hCaptcha was already rendered.");if(!this.hcaptcha)return void this.$emit("error",{error:"hCaptcha was not loaded yet. Please wait for `loaded` event to safely call `render`."});const t={sitekey:this.config.sitekey,theme:this.config.theme,size:this.config.size,tabindex:this.config.tabindex,callback:this.onVerify.bind(this),"expired-callback":this.onExpired.bind(this),"chalexpired-callback":this.onChallengeExpired.bind(this),"error-callback":this.onError.bind(this),"open-callback":this.onOpen.bind(this),"close-callback":this.onClose.bind(this)};this.config.challengeContainer&&(t["challenge-container"]=this.config.challengeContainer),this.hcaptchaId=this.hcaptcha.render(this,t),this.rqdata&&this.hcaptcha.setData(this.hcaptchaId,{rqdata:this.rqdata}),this.onRendered()}execute(){this.hcaptcha?(this.hcaptcha.execute(this.hcaptchaId),this.onExecuted()):this.$emit("error",{error:"hCaptcha was not rendered yet. Please wait for `rendered` event to safely call `execute`."})}reset(){this.hcaptcha?(this.hcaptcha.reset(this.hcaptchaId),this.onReset()):this.$emit("error",{error:"hCaptcha was not rendered yet. Please wait for `rendered` event to safely call `reset`."})}remove(){this.hcaptcha?(this.hcaptcha.remove(this.hcaptchaId),this.onReset()):this.$emit("error",{error:"hCaptcha was not rendered yet. Please wait for `rendered` event to safely call `remove`."})}onRendered(){this.$emit("rendered")}onExecuted(){this.$emit("executed")}onReset(){this.$emit("reset")}onError(t){this.$emit("error",{error:t}),this.reset()}onVerify(){const t=this.hcaptcha.getResponse(this.hcaptchaId),e=this.hcaptcha.getRespKey(this.hcaptchaId);this.$emit("verified",{token:t,eKey:e,key:t})}onExpired(){this.$emit("expired")}onChallengeExpired(){this.$emit("challengeExpired")}onOpen(){this.$emit("opened")}onClose(){this.$emit("closed")}}customElements.define("h-captcha",s)}();
